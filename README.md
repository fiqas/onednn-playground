# Mixture of Experts oneDNN testbed

1. Compile, e.g. `mkdir build; cd build; cmake ..; make moe`
2. Run `moe.ipynb` to get a `data.npz` file for reference.
3. Execute built `moe` with `data.npz`, e.g. `build/src/moe data.npz`.

Example output:

```
Loaded npz from ../data.npz {
  b = <4b * 1>
  dst = <4b * 143>
  embedding_size = <8b * 1>
  expert_0_dst = <4b * 110>
  expert_0_src = <4b * 110>
  expert_1_dst = <4b * 110>
  expert_1_src = <4b * 110>
  expert_2_dst = <4b * 99>
  expert_2_src = <4b * 99>
  expert_3_dst = <4b * 132>
  expert_3_src = <4b * 132>
  expert_4_dst = <4b * 121>
  expert_4_src = <4b * 121>
  expert_count = <8b * 1>
  expert_size = <8b * 1>
  experts_b1 = <4b * 35>
  experts_b2 = <4b * 55>
  experts_w1 = <4b * 385>
  experts_w2 = <4b * 385>
  router = <1b * 65>
  src = <4b * 143>
  token_count = <8b * 1>
}
parameters {
  expert_count   = 5
  expert_size    = 7
  embedding_size = 11
  token_count    = 13
  b              = 0.1
}
src_data = (13x11) f {
   1.6243, -0.6118, -0.5282, -1.0730, ..., -0.7612,  0.3190, -0.2494,  1.4621
  -2.0601, -0.3224, -0.3841,  1.1338, ...,  0.0422,  0.5828, -1.1006,  1.1447
   0.9016,  0.5025,  0.9009, -0.6837, ...,  0.5304, -0.6917, -0.3968, -0.6872
  -0.8452, -0.6712, -0.0127, -1.1173, ..., -0.1918, -0.8876, -0.7472,  1.6925
   ...
   0.6980, -0.4471,  1.2245,  0.4035, ...,  0.7406, -0.9537, -0.2662,  0.0326
  -1.3731,  0.3152,  0.8462, -0.8595, ..., -1.6158,  1.1214,  0.4089, -0.0246
  -0.7752,  1.2738,  1.9671, -1.8580, ..., -1.1993,  0.8633, -0.1809, -0.6039
  -1.2301,  0.5505,  0.7928, -0.6235, ...,  0.0466, -0.1866, -0.1017,  0.8689
}
router = (5x13) h {
    1,   1,   1,   0, ...,   0,   1,   1,   1
    1,   0,   0,   1, ...,   1,   1,   1,   1
    0,   1,   1,   1, ...,   1,   0,   1,   1
    1,   1,   1,   1, ...,   1,   1,   1,   1
    1,   1,   1,   1, ...,   1,   1,   0,   0
}
Expert 0 gets 10 tokens
expert_0_src_mem = (10x11) f {
   1.6243, -0.6118, -0.5282, -1.0730, ..., -0.7612,  0.3190, -0.2494,  1.4621
  -2.0601, -0.3224, -0.3841,  1.1338, ...,  0.0422,  0.5828, -1.1006,  1.1447
   0.9016,  0.5025,  0.9009, -0.6837, ...,  0.5304, -0.6917, -0.3968, -0.6872
   0.0508, -0.6370,  0.1909,  2.1003, ..., -0.3522, -1.1425, -0.3493, -0.2089
   ...
   0.1218,  1.1295,  1.1989,  0.1852, ...,  0.0773, -0.3439,  0.0436, -0.6200
  -1.3731,  0.3152,  0.8462, -0.8595, ..., -1.6158,  1.1214,  0.4089, -0.0246
  -0.7752,  1.2738,  1.9671, -1.8580, ..., -1.1993,  0.8633, -0.1809, -0.6039
  -1.2301,  0.5505,  0.7928, -0.6235, ...,  0.0466, -0.1866, -0.1017,  0.8689
}
expected expert_0_src_mem = (10x11) f {
   1.6243, -0.6118, -0.5282, -1.0730, ..., -0.7612,  0.3190, -0.2494,  1.4621
  -2.0601, -0.3224, -0.3841,  1.1338, ...,  0.0422,  0.5828, -1.1006,  1.1447
   0.9016,  0.5025,  0.9009, -0.6837, ...,  0.5304, -0.6917, -0.3968, -0.6872
   0.0508, -0.6370,  0.1909,  2.1003, ..., -0.3522, -1.1425, -0.3493, -0.2089
   ...
   0.1218,  1.1295,  1.1989,  0.1852, ...,  0.0773, -0.3439,  0.0436, -0.6200
  -1.3731,  0.3152,  0.8462, -0.8595, ..., -1.6158,  1.1214,  0.4089, -0.0246
  -0.7752,  1.2738,  1.9671, -1.8580, ..., -1.1993,  0.8633, -0.1809, -0.6039
  -1.2301,  0.5505,  0.7928, -0.6235, ...,  0.0466, -0.1866, -0.1017,  0.8689
}
expert_0_dst = (10x11) f {
   3.8454,  6.6285,  0.3704,  0.0000, ...,  0.0000,  8.2471,  0.0000, 17.0787
   1.4818,  3.5549,  3.3111,  2.5408, ...,  0.0000,  8.9882,  3.9864,  7.9464
   0.8640,  0.0000,  7.1841,  0.0000, ...,  0.0000,  2.9526,  0.0000,  8.4643
   2.1443,  0.0000,  7.3256,  1.2095, ...,  0.0000,  0.0000,  2.9542,  6.1195
   ...
   1.4678,  2.6703,  0.0000,  1.5422, ...,  0.0374,  3.0991,  0.0000,  3.3244
   2.2081,  1.9758,  0.0000,  2.4843, ...,  0.0000,  0.3359,  0.0000,  2.3173
   7.3888,  0.0000,  1.3750,  0.0000, ...,  0.0000,  2.6822,  0.0000,  5.8795
   3.8775,  2.2231,  0.0000,  0.0000, ...,  1.0846,  7.3921,  0.0992,  7.8337
}
expected expert_0_dst_mem = (10x11) f {
   3.8454,  6.6285,  0.3704,  0.0000, ...,  0.0000,  8.2471,  0.0000, 17.0787
   1.4818,  3.5549,  3.3111,  2.5408, ...,  0.0000,  8.9882,  3.9864,  7.9464
   0.8640,  0.0000,  7.1841,  0.0000, ...,  0.0000,  2.9526,  0.0000,  8.4643
   2.1443,  0.0000,  7.3256,  1.2095, ...,  0.0000,  0.0000,  2.9542,  6.1195
   ...
   1.4678,  2.6703,  0.0000,  1.5422, ...,  0.0374,  3.0991,  0.0000,  3.3244
   2.2081,  1.9758,  0.0000,  2.4843, ...,  0.0000,  0.3359,  0.0000,  2.3173
   7.3888,  0.0000,  1.3750,  0.0000, ...,  0.0000,  2.6822,  0.0000,  5.8795
   3.8775,  2.2231,  0.0000,  0.0000, ...,  1.0846,  7.3921,  0.0992,  7.8337
}
Expert 1 gets 10 tokens
expert_1_src_mem = (10x11) f {
   1.6243, -0.6118, -0.5282, -1.0730, ..., -0.7612,  0.3190, -0.2494,  1.4621
  -0.8452, -0.6712, -0.0127, -1.1173, ..., -0.1918, -0.8876, -0.7472,  1.6925
   0.0508, -0.6370,  0.1909,  2.1003, ..., -0.3522, -1.1425, -0.3493, -0.2089
   0.5866,  0.8390,  0.9311,  0.2856, ...,  0.5129, -0.2981,  0.4885, -0.0756
   ...
   0.6980, -0.4471,  1.2245,  0.4035, ...,  0.7406, -0.9537, -0.2662,  0.0326
  -1.3731,  0.3152,  0.8462, -0.8595, ..., -1.6158,  1.1214,  0.4089, -0.0246
  -0.7752,  1.2738,  1.9671, -1.8580, ..., -1.1993,  0.8633, -0.1809, -0.6039
  -1.2301,  0.5505,  0.7928, -0.6235, ...,  0.0466, -0.1866, -0.1017,  0.8689
}
expected expert_1_src_mem = (10x11) f {
   1.6243, -0.6118, -0.5282, -1.0730, ..., -0.7612,  0.3190, -0.2494,  1.4621
  -0.8452, -0.6712, -0.0127, -1.1173, ..., -0.1918, -0.8876, -0.7472,  1.6925
   0.0508, -0.6370,  0.1909,  2.1003, ..., -0.3522, -1.1425, -0.3493, -0.2089
   0.5866,  0.8390,  0.9311,  0.2856, ...,  0.5129, -0.2981,  0.4885, -0.0756
   ...
   0.6980, -0.4471,  1.2245,  0.4035, ...,  0.7406, -0.9537, -0.2662,  0.0326
  -1.3731,  0.3152,  0.8462, -0.8595, ..., -1.6158,  1.1214,  0.4089, -0.0246
  -0.7752,  1.2738,  1.9671, -1.8580, ..., -1.1993,  0.8633, -0.1809, -0.6039
  -1.2301,  0.5505,  0.7928, -0.6235, ...,  0.0466, -0.1866, -0.1017,  0.8689
}
expert_1_dst = (10x11) f {
   2.1662, 15.0874,  0.0000,  0.0000, ...,  0.0000,  0.0000,  2.6101, 10.1011
   2.3421,  1.9219,  4.2822,  0.0000, ...,  0.0000,  0.0000,  0.2337,  0.0000
   3.8280,  1.8096,  3.5940,  0.0000, ...,  0.0000,  1.6438,  0.0000,  0.0000
   3.0365,  9.7752,  0.0662,  0.0000, ...,  0.0000,  2.8769,  0.0000,  4.6649
   ...
   4.1130,  7.2836,  0.8665,  0.0000, ...,  0.0000,  2.4730,  0.0000,  4.1599
   0.0000,  5.5667,  0.0000,  0.0000, ...,  0.2722,  0.5536,  6.6009,  0.0000
   0.0000,  3.5915,  3.6707,  0.0000, ...,  0.0000,  3.2248,  0.0000,  0.0000
   0.0000,  4.7415,  0.0000,  0.0000, ...,  0.0000,  0.1007,  5.1449,  0.0000
}
expected expert_1_dst_mem = (10x11) f {
   2.1662, 15.0874,  0.0000,  0.0000, ...,  0.0000,  0.0000,  2.6101, 10.1011
   2.3421,  1.9219,  4.2822,  0.0000, ...,  0.0000,  0.0000,  0.2337,  0.0000
   3.8280,  1.8096,  3.5940,  0.0000, ...,  0.0000,  1.6438,  0.0000,  0.0000
   3.0365,  9.7752,  0.0662,  0.0000, ...,  0.0000,  2.8769,  0.0000,  4.6649
   ...
   4.1130,  7.2836,  0.8665,  0.0000, ...,  0.0000,  2.4730,  0.0000,  4.1599
   0.0000,  5.5667,  0.0000,  0.0000, ...,  0.2722,  0.5536,  6.6009,  0.0000
   0.0000,  3.5915,  3.6707,  0.0000, ...,  0.0000,  3.2248,  0.0000,  0.0000
   0.0000,  4.7414,  0.0000,  0.0000, ...,  0.0000,  0.1007,  5.1449,  0.0000
}
Expert 2 gets 9 tokens
expert_2_src_mem = (9x11) f {
  -2.0601, -0.3224, -0.3841,  1.1338, ...,  0.0422,  0.5828, -1.1006,  1.1447
   0.9016,  0.5025,  0.9009, -0.6837, ...,  0.5304, -0.6917, -0.3968, -0.6872
  -0.8452, -0.6712, -0.0127, -1.1173, ..., -0.1918, -0.8876, -0.7472,  1.6925
   0.0508, -0.6370,  0.1909,  2.1003, ..., -0.3522, -1.1425, -0.3493, -0.2089
   ...
   0.1218,  1.1295,  1.1989,  0.1852, ...,  0.0773, -0.3439,  0.0436, -0.6200
   0.6980, -0.4471,  1.2245,  0.4035, ...,  0.7406, -0.9537, -0.2662,  0.0326
  -0.7752,  1.2738,  1.9671, -1.8580, ..., -1.1993,  0.8633, -0.1809, -0.6039
  -1.2301,  0.5505,  0.7928, -0.6235, ...,  0.0466, -0.1866, -0.1017,  0.8689
}
expected expert_2_src_mem = (9x11) f {
  -2.0601, -0.3224, -0.3841,  1.1338, ...,  0.0422,  0.5828, -1.1006,  1.1447
   0.9016,  0.5025,  0.9009, -0.6837, ...,  0.5304, -0.6917, -0.3968, -0.6872
  -0.8452, -0.6712, -0.0127, -1.1173, ..., -0.1918, -0.8876, -0.7472,  1.6925
   0.0508, -0.6370,  0.1909,  2.1003, ..., -0.3522, -1.1425, -0.3493, -0.2089
   ...
   0.1218,  1.1295,  1.1989,  0.1852, ...,  0.0773, -0.3439,  0.0436, -0.6200
   0.6980, -0.4471,  1.2245,  0.4035, ...,  0.7406, -0.9537, -0.2662,  0.0326
  -0.7752,  1.2738,  1.9671, -1.8580, ..., -1.1993,  0.8633, -0.1809, -0.6039
  -1.2301,  0.5505,  0.7928, -0.6235, ...,  0.0466, -0.1866, -0.1017,  0.8689
}
expert_2_dst = (9x11) f {
   1.1609,  1.9430,  1.6613,  0.0000, ...,  0.0000,  2.2939,  0.0000,  0.0000
   8.6128,  5.7203,  5.3427,  0.0000, ...,  0.0000,  4.6949,  0.0000,  0.0000
   0.0000,  2.4189,  5.7680,  0.0000, ...,  0.0000,  2.0616,  0.0000,  0.0000
   0.7066,  1.4150,  0.0000,  0.0000, ...,  0.0000,  0.8199,  0.2735,  0.6381
   ...
   2.4546,  6.8243,  3.4993,  0.0000, ...,  0.0000,  3.9677,  0.0000,  0.0000
   6.8416,  2.6171,  6.4060,  0.0000, ...,  0.0000,  4.0534,  0.0000,  3.4920
   5.0894,  6.6323,  9.0721,  0.0000, ...,  0.0000,  3.1524,  0.0000,  0.0000
   2.1925,  6.7624,  7.7640,  0.0000, ...,  0.0000,  6.7193,  0.0000,  0.0000
}
expected expert_2_dst_mem = (9x11) f {
   1.1609,  1.9430,  1.6613,  0.0000, ...,  0.0000,  2.2939,  0.0000,  0.0000
   8.6128,  5.7203,  5.3427,  0.0000, ...,  0.0000,  4.6949,  0.0000,  0.0000
   0.0000,  2.4189,  5.7680,  0.0000, ...,  0.0000,  2.0616,  0.0000,  0.0000
   0.7066,  1.4150,  0.0000,  0.0000, ...,  0.0000,  0.8199,  0.2735,  0.6381
   ...
   2.4546,  6.8243,  3.4993,  0.0000, ...,  0.0000,  3.9677,  0.0000,  0.0000
   6.8416,  2.6171,  6.4060,  0.0000, ...,  0.0000,  4.0534,  0.0000,  3.4920
   5.0894,  6.6323,  9.0721,  0.0000, ...,  0.0000,  3.1524,  0.0000,  0.0000
   2.1925,  6.7624,  7.7640,  0.0000, ...,  0.0000,  6.7193,  0.0000,  0.0000
}
Expert 3 gets 12 tokens
expert_3_src_mem = (12x11) f {
   1.6243, -0.6118, -0.5282, -1.0730, ..., -0.7612,  0.3190, -0.2494,  1.4621
  -2.0601, -0.3224, -0.3841,  1.1338, ...,  0.0422,  0.5828, -1.1006,  1.1447
   0.9016,  0.5025,  0.9009, -0.6837, ...,  0.5304, -0.6917, -0.3968, -0.6872
  -0.8452, -0.6712, -0.0127, -1.1173, ..., -0.1918, -0.8876, -0.7472,  1.6925
   ...
   0.6980, -0.4471,  1.2245,  0.4035, ...,  0.7406, -0.9537, -0.2662,  0.0326
  -1.3731,  0.3152,  0.8462, -0.8595, ..., -1.6158,  1.1214,  0.4089, -0.0246
  -0.7752,  1.2738,  1.9671, -1.8580, ..., -1.1993,  0.8633, -0.1809, -0.6039
  -1.2301,  0.5505,  0.7928, -0.6235, ...,  0.0466, -0.1866, -0.1017,  0.8689
}
expected expert_3_src_mem = (12x11) f {
   1.6243, -0.6118, -0.5282, -1.0730, ..., -0.7612,  0.3190, -0.2494,  1.4621
  -2.0601, -0.3224, -0.3841,  1.1338, ...,  0.0422,  0.5828, -1.1006,  1.1447
   0.9016,  0.5025,  0.9009, -0.6837, ...,  0.5304, -0.6917, -0.3968, -0.6872
  -0.8452, -0.6712, -0.0127, -1.1173, ..., -0.1918, -0.8876, -0.7472,  1.6925
   ...
   0.6980, -0.4471,  1.2245,  0.4035, ...,  0.7406, -0.9537, -0.2662,  0.0326
  -1.3731,  0.3152,  0.8462, -0.8595, ..., -1.6158,  1.1214,  0.4089, -0.0246
  -0.7752,  1.2738,  1.9671, -1.8580, ..., -1.1993,  0.8633, -0.1809, -0.6039
  -1.2301,  0.5505,  0.7928, -0.6235, ...,  0.0466, -0.1866, -0.1017,  0.8689
}
expert_3_dst = (12x11) f {
   3.9200,  2.5508,  9.6846,  0.0000, ..., 11.1122,  2.8582, 24.5443,  3.8041
   4.4535,  6.9576, 11.8348,  6.7390, ..., 20.5621,  0.0000,  0.0000,  0.0000
   0.6393,  2.1484,  0.0000,  0.0000, ...,  2.2218,  1.5692,  2.2585,  0.6129
   1.7071,  0.0000,  0.1900,  0.7674, ...,  0.2370,  2.8419,  3.3134,  0.6965
   ...
   0.7046,  1.4264,  0.9186,  0.0000, ...,  2.5331,  0.8758,  4.6813,  0.5547
   0.0000,  2.0328,  0.0000,  0.0000, ...,  0.8805,  4.1409,  0.9953,  2.7832
   2.6970,  0.0324,  0.0000,  0.9932, ...,  0.0000,  6.9301,  0.0000,  1.3668
   4.1502,  2.1230,  0.0000,  0.0000, ...,  4.5468,  1.7928,  5.3930,  0.0000
}
expected expert_3_dst_mem = (12x11) f {
   3.9200,  2.5508,  9.6846,  0.0000, ..., 11.1122,  2.8582, 24.5443,  3.8041
   4.4535,  6.9576, 11.8348,  6.7390, ..., 20.5621,  0.0000,  0.0000,  0.0000
   0.6393,  2.1484,  0.0000,  0.0000, ...,  2.2218,  1.5692,  2.2585,  0.6129
   1.7071,  0.0000,  0.1900,  0.7674, ...,  0.2370,  2.8419,  3.3134,  0.6965
   ...
   0.7046,  1.4264,  0.9186,  0.0000, ...,  2.5331,  0.8758,  4.6813,  0.5547
   0.0000,  2.0328,  0.0000,  0.0000, ...,  0.8805,  4.1409,  0.9953,  2.7832
   2.6970,  0.0324,  0.0000,  0.9932, ...,  0.0000,  6.9301,  0.0000,  1.3668
   4.1502,  2.1230,  0.0000,  0.0000, ...,  4.5468,  1.7928,  5.3930,  0.0000
}
Expert 4 gets 11 tokens
expert_4_src_mem = (11x11) f {
   1.6243, -0.6118, -0.5282, -1.0730, ..., -0.7612,  0.3190, -0.2494,  1.4621
  -2.0601, -0.3224, -0.3841,  1.1338, ...,  0.0422,  0.5828, -1.1006,  1.1447
   0.9016,  0.5025,  0.9009, -0.6837, ...,  0.5304, -0.6917, -0.3968, -0.6872
  -0.8452, -0.6712, -0.0127, -1.1173, ..., -0.1918, -0.8876, -0.7472,  1.6925
   ...
   0.8280,  0.2301,  0.7620, -0.2223, ...,  0.1983,  0.1190, -0.6707,  0.3776
   0.1218,  1.1295,  1.1989,  0.1852, ...,  0.0773, -0.3439,  0.0436, -0.6200
   0.6980, -0.4471,  1.2245,  0.4035, ...,  0.7406, -0.9537, -0.2662,  0.0326
  -1.3731,  0.3152,  0.8462, -0.8595, ..., -1.6158,  1.1214,  0.4089, -0.0246
}
expected expert_4_src_mem = (11x11) f {
   1.6243, -0.6118, -0.5282, -1.0730, ..., -0.7612,  0.3190, -0.2494,  1.4621
  -2.0601, -0.3224, -0.3841,  1.1338, ...,  0.0422,  0.5828, -1.1006,  1.1447
   0.9016,  0.5025,  0.9009, -0.6837, ...,  0.5304, -0.6917, -0.3968, -0.6872
  -0.8452, -0.6712, -0.0127, -1.1173, ..., -0.1918, -0.8876, -0.7472,  1.6925
   ...
   0.8280,  0.2301,  0.7620, -0.2223, ...,  0.1983,  0.1190, -0.6707,  0.3776
   0.1218,  1.1295,  1.1989,  0.1852, ...,  0.0773, -0.3439,  0.0436, -0.6200
   0.6980, -0.4471,  1.2245,  0.4035, ...,  0.7406, -0.9537, -0.2662,  0.0326
  -1.3731,  0.3152,  0.8462, -0.8595, ..., -1.6158,  1.1214,  0.4089, -0.0246
}
expert_4_dst = (11x11) f {
   2.3411,  0.0000, 14.1637,  0.0000, ...,  7.8975,  0.0000,  0.0000,  7.5825
   4.5117,  0.0000,  2.0297,  0.0000, ...,  0.0000,  3.5166,  0.0000,  0.0000
   3.3957,  2.1153,  1.4710,  1.3462, ...,  2.0928,  0.0000,  0.0000,  1.1728
   2.6579,  0.0000,  5.2405,  0.0000, ...,  0.0000,  2.6791,  0.0000,  0.1930
   ...
   1.0070,  0.0000,  4.6567,  0.0000, ...,  0.0000,  0.0000,  0.0000,  0.0000
   2.4345,  2.5174,  0.7773,  2.0496, ...,  0.3815,  0.0000,  0.0000,  2.0837
   3.4781,  2.7869,  0.1837,  1.5345, ...,  0.0000,  0.0000,  0.0000,  0.0000
   4.3856,  0.0000, 11.0046,  0.0000, ...,  9.1856,  0.0000,  0.0000,  6.8009
}
expected expert_4_dst_mem = (11x11) f {
   2.3411,  0.0000, 14.1637,  0.0000, ...,  7.8975,  0.0000,  0.0000,  7.5825
   4.5117,  0.0000,  2.0297,  0.0000, ...,  0.0000,  3.5166,  0.0000,  0.0000
   3.3957,  2.1153,  1.4710,  1.3462, ...,  2.0928,  0.0000,  0.0000,  1.1728
   2.6579,  0.0000,  5.2405,  0.0000, ...,  0.0000,  2.6791,  0.0000,  0.1930
   ...
   1.0070,  0.0000,  4.6567,  0.0000, ...,  0.0000,  0.0000,  0.0000,  0.0000
   2.4345,  2.5174,  0.7773,  2.0496, ...,  0.3815,  0.0000,  0.0000,  2.0837
   3.4781,  2.7869,  0.1837,  1.5345, ...,  0.0000,  0.0000,  0.0000,  0.0000
   4.3856,  0.0000, 11.0046,  0.0000, ...,  9.1856,  0.0000,  0.0000,  6.8009
}
final dst_data =    (13x11) f {
  12.4351, 24.2056, 24.1659, -0.1073, ..., 18.9336, 11.1372, 27.1295, 38.7126
  11.4019, 12.4233, 18.7985,  9.3932, ..., 20.5663, 14.8570,  3.8763,  8.0609
  13.6019, 10.0343, 14.0879,  1.2778, ...,  4.3677,  9.1475,  2.2189, 10.1813
   6.6225,  4.2736, 15.4795,  0.6556, ...,  0.2178,  7.4939,  3.4723,  1.0588
   ...
  15.2072, 14.0693,  8.4973,  1.5748, ...,  2.6072,  7.3068,  4.6547,  8.2098
   6.4564,  9.6069, 11.0893,  2.3983, ..., 10.1767,  5.1425,  7.6370, 11.8989
  15.0977, 10.3835, 14.3145,  0.8074, ..., -0.1199, 16.0757, -0.0181,  7.1860
  10.0972, 15.9050,  7.8433, -0.0624, ...,  5.6361, 15.9863, 10.6269,  7.9206
}
expected dst_data = (13x11) f {
  12.4351, 24.2056, 24.1659, -0.1073, ..., 18.9336, 11.1372, 27.1295, 38.7126
  11.4019, 12.4233, 18.7985,  9.3932, ..., 20.5663, 14.8570,  3.8763,  8.0609
  13.6019, 10.0343, 14.0879,  1.2778, ...,  4.3677,  9.1475,  2.2189, 10.1813
   6.6225,  4.2736, 15.4795,  0.6556, ...,  0.2178,  7.4939,  3.4723,  1.0588
   ...
  15.2072, 14.0693,  8.4973,  1.5748, ...,  2.6072,  7.3068,  4.6547,  8.2098
   6.4564,  9.6069, 11.0893,  2.3983, ..., 10.1767,  5.1425,  7.6370, 11.8989
  15.0977, 10.3835, 14.3145,  0.8074, ..., -0.1199, 16.0757, -0.0181,  7.1860
  10.0972, 15.9050,  7.8433, -0.0624, ...,  5.6361, 15.9863, 10.6269,  7.9206
}
sum(|a-b|) = 0.000074
```
